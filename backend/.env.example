# ZMART Backend Environment Variables
# Version: 0.69.0
# Last Updated: November 9, 2025
# ðŸ”¥ GAP 10 FIX: Comprehensive environment variable documentation

# ==============================================================================
# API GATEWAY
# ==============================================================================

# Server Configuration
PORT=4000
NODE_ENV=development  # development | production | test

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# ==============================================================================
# WEBSOCKET SERVER
# ==============================================================================

WS_PORT=4001
WS_HOST=0.0.0.0

# ==============================================================================
# DATABASE (Supabase)
# ==============================================================================

# Get these from: https://app.supabase.com/project/_/settings/api
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here  # KEEP SECRET!

# Database connection (optional, for direct access)
DATABASE_URL=postgresql://postgres:[password]@db.your-project.supabase.co:5432/postgres

# ==============================================================================
# SOLANA
# ==============================================================================

# Network: devnet | testnet | mainnet-beta | localnet
SOLANA_NETWORK=devnet

# RPC URLs
SOLANA_RPC_URL=https://api.devnet.solana.com
# For production, use paid RPC:
# SOLANA_RPC_URL=https://your-project.helius-rpc.com/?api-key=your-api-key

# Program IDs
SOLANA_PROGRAM_ID_CORE=7h3gXfBfYFueFVLYyfL5Qo1QGsf4GQUfW96FKVgnUsJS
SOLANA_PROGRAM_ID_PROPOSAL=3XDU9r97qqJRdgqKJEWDYSJesPAUbLqsejXus4WLuhAQ

# Backend Authority Keypair (SECURE - Never commit .env!)
# Generate with: solana-keygen new -o ~/.config/solana/backend-authority.json
# Get base58 private key with: solana-keygen pubkey ~/.config/solana/backend-authority.json
BACKEND_KEYPAIR_PATH=/path/to/backend-authority.json
BACKEND_AUTHORITY_PRIVATE_KEY=your-base58-encoded-private-key-here

# Admin Wallet (for emergency operations)
ADMIN_WALLET_PUBKEY=4WQwPjKHu3x7dHBEehBDgxXHJQoDuBvj6Xhu6C1jjTye

# ==============================================================================
# EVENT INDEXER
# ==============================================================================

# Helius API (for blockchain event indexing)
# Get key from: https://dashboard.helius.dev/
HELIUS_API_KEY=your-helius-api-key-here
HELIUS_RPC_URL=https://devnet.helius-rpc.com/?api-key=your-helius-api-key
HELIUS_WEBHOOK_URL=https://api.helius.xyz/v0/webhooks
HELIUS_WEBHOOK_SECRET=your-webhook-secret-here

# Event indexer service
EVENT_INDEXER_PORT=4002
EVENT_INDEXER_ENABLED=true

# ==============================================================================
# IPFS / PINATA (for discussion storage)
# ==============================================================================

# Option 1: Pinata (Recommended)
# Get from: https://app.pinata.cloud/developers/api-keys
PINATA_API_KEY=your-pinata-api-key
PINATA_API_SECRET=your-pinata-api-secret
PINATA_JWT=your-pinata-jwt

# Option 2: Infura IPFS
IPFS_PROJECT_ID=your-ipfs-project-id
IPFS_PROJECT_SECRET=your-ipfs-project-secret
IPFS_GATEWAY_URL=https://ipfs.infura.io:5001

# IPFS Gateway
IPFS_GATEWAY=https://gateway.pinata.cloud

# Snapshot Configuration
IPFS_SNAPSHOT_CRON=0 0 * * *  # Daily at midnight

# ==============================================================================
# REDIS (for vote aggregation & caching)
# ==============================================================================

# Local Redis
REDIS_URL=redis://localhost:6379
# Production (e.g., Upstash)
# REDIS_URL=rediss://default:[password]@your-instance.upstash.io:6379

# Redis configuration
REDIS_PASSWORD=
REDIS_TLS_ENABLED=false

# ==============================================================================
# VOTE AGGREGATOR SERVICE
# ==============================================================================

VOTE_AGGREGATOR_PORT=4003
VOTE_AGGREGATION_INTERVAL=300000  # 5 minutes (in milliseconds)

# Vote thresholds
MIN_PROPOSAL_VOTES=10
PROPOSAL_APPROVAL_THRESHOLD=0.7  # 70%
DISPUTE_THRESHOLD=0.6            # 60%

# ==============================================================================
# MARKET MONITOR SERVICE
# ==============================================================================

MARKET_MONITOR_PORT=4004
MARKET_MONITOR_INTERVAL=60000  # 1 minute (in milliseconds)

# Auto-finalization settings
AUTO_FINALIZATION_ENABLED=true
FINALIZATION_DELAY_HOURS=48

# ==============================================================================
# AUTHENTICATION
# ==============================================================================

# Signature validity
AUTH_SIGNATURE_VALIDITY_MS=3600000  # 1 hour
AUTH_TIMESTAMP_WINDOW_MS=300000     # Â±5 minutes

# ==============================================================================
# LOGGING
# ==============================================================================

LOG_LEVEL=info  # debug | info | warn | error
LOG_TO_FILE=true
LOG_DIR=./logs

# ==============================================================================
# RATE LIMITING
# ==============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=60000  # 1 minute
RATE_LIMIT_MAX_REQUESTS=100

# ==============================================================================
# MONITORING & ALERTS
# ==============================================================================

# Sentry (error tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# ==============================================================================
# SECURITY
# ==============================================================================

# Allow list for admin operations (comma-separated wallet addresses)
ADMIN_WHITELIST=4WQwPjKHu3x7dHBEehBDgxXHJQoDuBvj6Xhu6C1jjTye

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

FEATURE_DISCUSSIONS_ENABLED=true
FEATURE_IPFS_SNAPSHOTS_ENABLED=false  # V2 feature
FEATURE_WEBSOCKET_ENABLED=true
FEATURE_EVENT_INDEXER_ENABLED=true

# ==============================================================================
# DEVELOPMENT ONLY
# ==============================================================================

# Verbose logging for debugging
DEBUG=false
VERBOSE_ERRORS=true

# Skip certain validations (NEVER use in production!)
SKIP_AUTH_VALIDATION=false
SKIP_RATE_LIMITING=false
